---
title: Unicode、UTF-8等编码的简单了解
layout: post
categories:
 - diary
---

什么是编码：在计算机中，所有的数据在存储和运算时都要使用二进制数(0、1)表示，像`a~z`、`A~Z`、`0~9`、`* # @ ...`在计算机中存储时也要使用二进制数来表示，而具体用哪些二进制数字表示哪个符号，每个人都可以约定自己的一套规则，这就是编码。

* `ASCII`编码是最简单的**西文**编码方案。
* `GB2312`、`GBK`、`GB18030`编码是**汉字字符**编码方案的国家标准。
* `ISO/IEC 10646`、`Unicode`编码是**全球字符**编码的国际标准。

## 二进制(Binary)、比特(Bit)、字节(Byte)

### 二进制(Binary)

* `二进制`:在二进制系统中，每个`0`或`1`就是一个**位(Bit)**。位是数据存储的最小单位。
* `CPU位数`: 指的是CPU一次能处理的最大位数。【例如32位计算机的CPU一次最多能处理32位数据。】

|二进制|十六进制|
|---|---|
|0000|0|
|0001|1|
|0010|2|
|0011|3|
|0100|4|
|0101|5|
|0110|6|
|0111|7|
|1000|8|
|1001|9|
|1010|A|
|1011|B|
|1100|C|
|1101|D|
|1110|E|
|1111|F|

### 比特(Bit)

* `Bit`：就是二进制数(Binary digit)的缩写。
* `比特(Bit)`:是指信息量单位，也是二进制数字中的`位`。二进制数的`1位`包含的信息等于`1比特`。【例如：二进制：`0100` = `4`Bit】

### 字节(Byte)

早期的计算机的编码设计为`ASCII`编码，只支持英语。`ASCII`的设计原理是用`8`位二进制数的组合来表示`256`种可能的字符。后来就规定`字节(Byte)`。

**<mark>1字节(Byte) = 8位长度的二进制 = 8比特(Bit)</mark>**

* `ASCII编码`：也就是`1Byte`可以表示`ASCII`编码中的任意的一个字符。一个英文字母(`A~Z`或`a~z`)或者一个数字(`0~9`)就为一个字节(`1Byte`)。
* `UTF-8编码`：一个英文字符等于一个字节；一个中文（含繁体）等于三个字节。
* `Unicode编码`：一个英文字符等于两个字节；一个中文（含繁体）等于两个字节。

```
1B = 8 Bit
1KB(Kilobyte) = 2^10B = 1024B
1MB(Megabyte) = 2^20B = 2^10KB = 1024KB
1GB(Gigabyte) = 2^30B = 2^20KB = 2^10MB = 1024MB
1TB(Gigabyte) = 2^40B = 2^30KB = 2^20MB = 2^10GB = 1024GB
```

## ASCII

`ASCII(American Standard Code for Information Interchange:美国信息交换标准代码)`：是基于拉丁字母的一套电脑编码系统，用指定的`7`位或`8`位二进制数的组合来表示`128(2^7)`或`256(2^8)`种可能的字符。

|Bin(二进制)		|	Oct(八进制)	|	Dec(十进制)	|	Hex(十六进制)	|	缩写/字符	|	解释|
|---|---|---|---|---|---|
|0000 0000	|	00	    |	<mark>0	</mark>     |	0x00	|	NUL(null)	|	空字符|
|0000 0001	|	01	    |	<mark>1	</mark>     |	0x01	|	SOH(start of headline)	|	标题开始|
|0000 0010	|	02	    |	<mark>2	</mark>     |	0x02	|	STX (start of text)	|	正文开始|
|0000 0011	|	03	    |	<mark>3	</mark>     |	0x03	|	ETX (end of text)	|	正文结束|
|0000 0100	|	04	    |	<mark>4	</mark>     |	0x04	|	EOT (end of transmission)	|	传输结束|
|0000 0101	|	05	    |	<mark>5	</mark>     |	0x05	|	ENQ (enquiry)	|	请求|
|0000 0110	|	06	    |	<mark>6	</mark>     |	0x06	|	ACK (acknowledge)	|	收到通知|
|0000 0111	|	07	    |	<mark>7	</mark>     |	0x07	|	BEL (bell)	|	响铃|
|0000 1000	|	010	    |	<mark>8	</mark>     |	0x08	|	BS (backspace)	|	退格|
|0000 1001	|	011	    |	<mark>9	</mark>     |	0x09	|	HT (horizontal tab)	|	水平制表符|
|0000 1010	|	012	    |	<mark>10</mark> 	|	0x0A	|	LF (NL line feed, new line)	|	换行键|
|0000 1011	|	013	    |	<mark>11</mark> 	|	0x0B	|	VT (vertical tab)	|	垂直制表符|
|0000 1100	|	014	    |	<mark>12</mark> 	|	0x0C	|	FF (NP form feed, new page)	|	换页键|
|0000 1101	|	015	    |	<mark>13</mark> 	|	0x0D	|	CR (carriage return)	|	回车键|
|0000 1110	|	016	    |	<mark>14</mark> 	|	0x0E	|	SO (shift out)	|	不用切换|
|0000 1111	|	017	    |	<mark>15</mark> 	|	0x0F	|	SI (shift in)	|	启用切换|
|0001 0000	|	020	    |	<mark>16</mark> 	|	0x10	|	DLE (data link escape)	|	数据链路转义|
|0001 0001	|	021	    |	<mark>17</mark> 	|	0x11	|	DC1 (device control 1)	|	设备控制1|
|0001 0010	|	022	    |	<mark>18</mark> 	|	0x12	|	DC2 (device control 2)	|	设备控制2|
|0001 0011	|	023	    |	<mark>19</mark> 	|	0x13	|	DC3 (device control 3)	|	设备控制3|
|0001 0100	|	024	    |	<mark>20</mark> 	|	0x14	|	DC4 (device control 4)	|	设备控制4|
|0001 0101	|	025	    |	<mark>21</mark> 	|	0x15	|	NAK (negative acknowledge)	|	拒绝接收|
|0001 0110	|	026	    |	<mark>22</mark> 	|	0x16	|	SYN (synchronous idle)	|	同步空闲|
|0001 0111	|	027	    |	<mark>23</mark> 	|	0x17	|	ETB (end of trans. block)	|	结束传输块|
|0001 1000	|	030	    |	<mark>24</mark> 	|	0x18	|	CAN (cancel)	|	取消|
|0001 1001	|	031	    |	<mark>25</mark> 	|	0x19	|	EM (end of medium)	|	媒介结束|
|0001 1010	|	032	    |	<mark>26</mark> 	|	0x1A	|	SUB (substitute)	|	代替|
|0001 1011	|	033	    |	<mark>27</mark> 	|	0x1B	|	ESC (escape)	|	换码(溢出)|
|0001 1100	|	034	    |	<mark>28</mark> 	|	0x1C	|	FS (file separator)	|	文件分隔符|
|0001 1101	|	035	    |	<mark>29</mark> 	|	0x1D	|	GS (group separator)	|	分组符|
|0001 1110	|	036	    |	<mark>30</mark> 	|	0x1E	|	RS (record separator)	|	记录分隔符|
|0001 1111	|	037	    |	<mark>31</mark> 	|	0x1F	|	US (unit separator)	|	单元分隔符|
|0010 0000	|	040	    |	32	                |	0x20	|	(space)	|	空格|
|0010 0001	|	041	    |	33	                |	0x21	|	!	|	叹号|
|0010 0010	|	042	    |	34	                |	0x22	|	"	|	双引号|
|0010 0011	|	043	    |	35	                |	0x23	|	#	|	井号|
|0010 0100	|	044	    |	36	                |	0x24	|	$	|	美元符|
|0010 0101	|	045	    |	37	                |	0x25	|	%	|	百分号|
|0010 0110	|	046	    |	38	                |	0x26	|	&	|	和号|
|0010 0111	|	047	    |	39	                |	0x27	|	'	|	闭单引号|
|0010 1000	|	050	    |	40	                |	0x28	|	(	|	开括号|
|0010 1001	|	051	    |	41	                |	0x29	|	)	|	闭括号|
|0010 1010	|	052	    |	42	                |	0x2A	|	*	|	星号|
|0010 1011	|	053	    |	43	                |	0x2B	|	+	|	加号|
|0010 1100	|	054	    |	44	                |	0x2C	|	,	|	逗号|
|0010 1101	|	055	    |	45	                |	0x2D	|	-	|	减号/破折号|
|0010 1110	|	056	    |	46	                |	0x2E	|	.	|	句号|
|0010 1111	|	057	    |	47	                |	0x2F	|	/	|	斜杠|
|0011 0000	|	060	    |	48	                |	0x30	|	0	|	字符0|
|0011 0001	|	061	    |	49	                |	0x31	|	1	|	字符1|
|0011 0010	|	062	    |	50	                |	0x32	|	2	|	字符2|
|0011 0011	|	063	    |	51	                |	0x33	|	3	|	字符3|
|0011 0100	|	064	    |	52	                |	0x34	|	4	|	字符4|
|0011 0101	|	065	    |	53	                |	0x35	|	5	|	字符5|
|0011 0110	|	066	    |	54	                |	0x36	|	6	|	字符6|
|0011 0111	|	067	    |	55	                |	0x37	|	7	|	字符7|
|0011 1000	|	070	    |	56	                |	0x38	|	8	|	字符8|
|0011 1001	|	071	    |	57	                |	0x39	|	9	|	字符9|
|0011 1010	|	072	    |	58	                |	0x3A	|	:	|	冒号|
|0011 1011	|	073	    |	59	                |	0x3B	|	;	|	分号|
|0011 1100	|	074	    |	60	                |	0x3C	|	<	|	小于|
|0011 1101	|	075	    |	61	                |	0x3D	|	=	|	等号|
|0011 1110	|	076	    |	62	                |	0x3E	|	>	|	大于|
|0011 1111	|	077	    |	63	                |	0x3F	|	?	|	问号|
|0100 0000	|	0100	|	64	                |	0x40	|	@	|	电子邮件符号|
|0100 0001	|	0101	|	65	                |	0x41	|	A	|	大写字母A|
|0100 0010	|	0102	|	66	                |	0x42	|	B	|	大写字母B|
|0100 0011	|	0103	|	67	                |	0x43	|	C	|	大写字母C|
|0100 0100	|	0104	|	68	                |	0x44	|	D	|	大写字母D|
|0100 0101	|	0105	|	69	                |	0x45	|	E	|	大写字母E|
|0100 0110	|	0106	|	70	                |	0x46	|	F	|	大写字母F|
|0100 0111	|	0107	|	71	                |	0x47	|	G	|	大写字母G|
|0100 1000	|	0110	|	72	                |	0x48	|	H	|	大写字母H|
|0100 1001	|	0111	|	73	                |	0x49	|	I	|	大写字母I|
|100 1010	|	0112	|	74	                |	0x4A	|	J	|	大写字母J|
|0100 1011	|	0113	|	75	                |	0x4B	|	K	|	大写字母K|
|0100 1100	|	0114	|	76	                |	0x4C	|	L	|	大写字母L|
|0100 1101	|	0115	|	77	                |	0x4D	|	M	|	大写字母M|
|0100 1110	|	0116	|	78	                |	0x4E	|	N	|	大写字母N|
|0100 1111	|	0117	|	79	                |	0x4F	|	O	|	大写字母O|
|0101 0000	|	0120	|	80	                |	0x50	|	P	|	大写字母P|
|0101 0001	|	0121	|	81	                |	0x51	|	Q	|	大写字母Q|
|0101 0010	|	0122	|	82	                |	0x52	|	R	|	大写字母R|
|0101 0011	|	0123	|	83	                |	0x53	|	S	|	大写字母S|
|0101 0100	|	0124	|	84	                |	0x54	|	T	|	大写字母T|
|0101 0101	|	0125	|	85	                |	0x55	|	U	|	大写字母U|
|0101 0110	|	0126	|	86	                |	0x56	|	V	|	大写字母V|
|0101 0111	|	0127	|	87	                |	0x57	|	W	|	大写字母W|
|0101 1000	|	0130	|	88	                |	0x58	|	X	|	大写字母X|
|0101 1001	|	0131	|	89	                |	0x59	|	Y	|	大写字母Y|
|0101 1010	|	0132	|	90	                |	0x5A	|	Z	|	大写字母Z|
|0101 1011	|	0133	|	91	                |	0x5B	|	[	|	开方括号|
|0101 1100	|	0134	|	92	                |	0x5C	|	\	|	反斜杠|
|0101 1101	|	0135	|	93	                |	0x5D	|	]	|	闭方括号|
|0101 1110	|	0136	|	94	                |	0x5E	|	^	|	脱字符|
|0101 1111	|	0137	|	95	                |	0x5F	|	_	|	下划线|
|0110 0000	|	0140	|	96	                |	0x60	|	`	|	开单引号|
|0110 0001	|	0141	|	97	                |	0x61	|	a	|	小写字母a|
|0110 0010	|	0142	|	98	                |	0x62	|	b	|	小写字母b|
|0110 0011	|	0143	|	99	                |	0x63	|	c	|	小写字母c|
|0110 0100	|	0144	|	100	                |	0x64	|	d	|	小写字母d|
|0110 0101	|	0145	|	101	                |	0x65	|	e	|	小写字母e|
|0110 0110	|	0146	|	102	                |	0x66	|	f	|	小写字母f|
|0110 0111	|	0147	|	103	                |	0x67	|	g	|	小写字母g|
|0110 1000	|	0150	|	104	                |	0x68	|	h	|	小写字母h|
|0110 1001	|	0151	|	105	                |	0x69	|	i	|	小写字母i|
|0110 1010	|	0152	|	106	                |	0x6A	|	j	|	小写字母j|
|0110 1011	|	0153	|	107	                |	0x6B	|	k	|	小写字母k|
|0110 1100	|	0154	|	108	                |	0x6C	|	l	|	小写字母l|
|0110 1101	|	0155	|	109	                |	0x6D	|	m	|	小写字母m|
|0110 1110	|	0156	|	110	                |	0x6E	|	n	|	小写字母n|
|0110 1111	|	0157	|	111	                |	0x6F	|	o	|	小写字母o|
|0111 0000	|	0160	|	112	                |	0x70	|	p	|	小写字母p|
|0111 0001	|	0161	|	113	                |	0x71	|	q	|	小写字母q|
|0111 0010	|	0162	|	114	                |	0x72	|	r	|	小写字母r|
|0111 0011	|	0163	|	115	                |	0x73	|	s	|	小写字母s|
|0111 0100	|	0164	|	116	                |	0x74	|	t	|	小写字母t|
|0111 0101	|	0165	|	117	                |	0x75	|	u	|	小写字母u|
|0111 0110	|	0166	|	118	                |	0x76	|	v	|	小写字母v|
|0111 0111	|	0167	|	119	                |	0x77	|	w	|	小写字母w|
|0111 1000	|	0170	|	120	                |	0x78	|	x	|	小写字母x|
|0111 1001	|	0171	|	121	                |	0x79	|	y	|	小写字母y|
|0111 1010	|	0172	|	122	                |	0x7A	|	z	|	小写字母z|
|0111 1011	|	0173	|	123	                |	0x7B	|	{	|	开花括号|
|0111 1100	|	0174	|	124	                |	0x7C	|	`|`	|	垂线|
|0111 1101	|	0175	|	125	                |	0x7D	|	}	|	闭花括号|
|0111 1110	|	0176	|	126	                |	0x7E	|	~	|	波浪号|
|0111 1111	|	0177	|	<mark>127</mark>	|	0x7F	|	DEL (delete)	|	删除|

* `0111 1111`: 使用了`7`位二进制数，剩下最左边1位二进制为`0`。在计算机的存储单元中，一个ASCII码值占一个字节(8个二进制位)，其最高位(b7)用作奇偶校验位。
* `0~31`、`127`：是控制字符或通讯字符。
* `32~126`：是可显示字符【`48~57`表示`0~9`；`65~90`表示`A~Z`；`97~122`表示`a~z`；其余为一些标点符号、运算符号等】
* 常见大小排序：`0~9<A~Z<a~z`

## Unicode

**编码模型**

* `Coded Character Set(CCS)`：将字符与唯一数值关联起来的映射。其中唯一的数值被称为`Code Point`。
* `Unicode`中`Code Point`的使用规则：`U+十六进制数`。【中文单字`我`的`Code Point`为`U+6211`】
* `ASCII`：一个字符使用1个字节。【`|0|1|0|1|0|1|0|1|`】
* `Unicode`：为了能表示多种字符，规定一个字符使用2个字节。【`|0|1|0|1|0|1|0|1|0|1|0|1|0|1|0|1|`】

`Unicode(统一码、万国码、单一码)`：它是一种计算机的行业标准，为每一个字符设定一个唯一的编码，以满足跨语言、跨平台进行文本转换、处理的要求。<br>
`Unicode`是国际组织制定的可以容纳世界上所有文字和符号的字符编码方案。根据字符的使用频率，`Unicode`被划分为17个组编排，范围从`0x0000` 至 `0x10FFFF`。其中每一组编排被称为一个`平面(Plane)`。
每个Plane包含了`2^16(65536)`个`Code Point`，一共`2^16*17(1,114,112)`个`Code Point`。

* `Plane 0`：**Basic Multilingual Plane(BMP)**。其中包含绝大多数现代字符，比如拉丁文、斯拉夫文、希腊文、汉字（中国），日文、朝鲜文、阿拉伯文、希伯来文、梵文（印度）等。
* `Plane 1`：**Supplementary Multilingual Plane(SMP)**。其中包含历史上的文字，比如苏美尔楔形文字、埃及象形文字、Emoji 以及其他符号。
* `Plane 2`：**Supplementary Ideographic Plane(SIP)**。其中包含不常用的和历史遗留的汉字字符。
* `Plane 3~13`：未被使用。
* `Plane 14`：**Supplement Special-purpose Plane(SSP)**。其中包含少量用于格式化的字符。
* `Plane 15`：**Supplement Private Use Area Plane A(SPUA-A)**。未被使用，留给第三方定义私有字符，以避免和 Unicode 冲突。
* `Plane 16`：**Supplement Private Use Area Plane B(SPUA-B)**。未被使用，留给第三方定义私有字符，以避免和 Unicode 冲突。

上面所有的Plane中`Plane 0`又简称为**零号平面**，它的空间范围是`U+0000 ~ U+FFFF`。在零号平面以外的字符则需要使用五位或六位十六进制数，从`Plane 1～16`的空间范围是`U+010000 ~ U+10FFFF`。

<img src="/assets/images/diary/coding-01.jpg" width = "100%" height = "100%"/>

图为`Unicode Plane`的整体布局，从左到右，从上至下，编号依次为 0 ～ 16，其中：

* 一个像素表示1个`Code Point`。【1个`Code Point`就是`2^16`种可能值中的一种，例如：中文汉字`我`:`110001000010001`或为`U+6211`】
* 一个小方块表示`2^8`个`Code Point`（只为保证视觉一致性，无特殊意义）
* 一个大方块表示一个 Plane，其中包含 2^16 个 Code Point
* 白色表示未用空间
* 蓝色表示已用空间
* 绿色表示自用空间
* 红色区域表示代理区，空间范围 U+D800～U+DFFF（描述 UTF-16 编码方案的时候会提及）

### Unicode 编码方案

`Unicode`只是定义了一个庞大的、全球通用的字符集，并为每个字符规定了唯一确定的编号，而`Unicode`字符如何存取，`Unicode`是不关心的。为了解决`Unicode`编码，产生比较流行的`Unicode`编码方案`Unicode Transformation Formats(UTF)`。

> `UTF-8/UTF-16/ UTF-32`中的数字表示`Code Unit`的大小(指定长度的`Bit`序列)。对UTF-8来言，`Code Unit`的大小是8。

#### UTF-32
`UTF-32`:`Code Unit`的大小是32，也就是32Bit，1Byte=8Bit，那么在`UTF-32`中使用4个字节来存储每个`Code Point`。

| 字符 | Code Point| 编码 |
| --- | --- | --- |
|我|U+0041|ox0000 0041|
|A |U+6211|ox0000 6211|
|?|U+2003E|ox0002 003E|

#### UTF-16
`UTF-16`:`Code Unit`的大小是16，也就是16Bit，1Byte=8Bit，那么在`UTF-16`中使用2个字节或者4个字节来存储每个`Code Point`。

`UTF-16`编码方案中，涉及到一个概念`代理区`。`代理区`位于`BMP`中，空间范围`U+D800～U+DFFF`。空间大小`2^11`，用于映射`Plane 1～16`中的所有`Code Point`。

```
代理区：

U+D800(十六进制) -> 55296(十进制) -> 1101100000000000(二进制)
U+DFFF(十六进制) -> 57343(十进制) -> 1101111111111111(二进制)
--> D800 - DFFF = 2047(十进制) -> 11111111111(二进制) -> 代理区空间大小：2^11

--> 那么 55296～57343 的中间值：(57343-55296-1)/2+55296 = 56319
55296~56319 -> U+D800~U+DDFF -> 代理区空间大小：2^10 -> 称为高位（H）
56320~57343 -> U+DC00~U+DFFF -> 代理区空间大小：2^10 -> 称为低位（L）
```

对高位和低位做迪卡尔积，可以得到 2^20 种组合。

| Code Point 范围 | 设置存储字节数 |
|---|---|
|`Plane 0`范围的字符:`U+0000 ~ U+FFFF`|使用2个字节存储|
|`Plane 1~16`范围的字符:`U+100000 ~ U+10FFFF`|使用4个字节存储|

##### 编码
###### `U+0000～U+FFFF`范围
`U+0000～U+FFFF`范围内的字符直接使用2字节存储。

| 字符 | Code Point| 编码 |
| --- | --- | --- |
|我|U+0041|ox0041|
|A |U+6211|ox6211|

###### `U+100000 ~ U+10FFFF`范围

* Code Point 减去 0x10000，获得一个在 0x00000～0xFFFFF 范围中的值，这个值可以转换为 20 位的二进制数。
* 20 位的二进制数的高 10 位与 0xD800 相加，获得高位。
* 20 位的二进制数的低 10 位与 0xDC00 相加，获得低位。
* 高位与低位组合后，刚好可以用 4 个字节表示。

##### 解码

## 参考资料

* [编码](https://baike.baidu.com/item/编码/80092)
* [字符，字节和编码](http://www.regexlab.com/zh/encoding.htm)
* [Unicode 及其编码方案](https://cloud.tencent.com/developer/article/1407949)









































